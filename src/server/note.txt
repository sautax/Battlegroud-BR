the server is directly coded in js for compatibility